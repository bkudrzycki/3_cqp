---
title: Benefits and Costs of Dual and Informal Apprenticeship in Bénin
author: 
  - name: Bart Kudrzycki
    affiliation: Development Economics Group, ETH Zurich, Switzerland, <bartlomiej.kudrzycki@nadel.ethz.ch>
date: \today
abstract: |
   This paper evaluates the costs and benefits of apprenticeship training in the informal sector in Benin using unique matched apprentice-firm survey data. Costs and benefits for the training firm and the trainee are investigated separately. Special attention is paid to the net benefits of the _Certificat de Qualification Professionelle_, program, a national dual training program. Two cost and benefit models of differing complexity are used: in the simplest, fees comprise all benefits for the firm, while apprentice wages and benefits represent total costs. In a second, more complex model, estimates of current and future productivity, apprentice retainment by the firm, and training costs are also considered. We find that...
   
thanks: |
  Thanks to Dario for the Markdown template.
keywords: [Informal labor markets, Dual training, Apprenticeship]
jel: [I26]
output: 
  bookdown::pdf_document2:
    latex_engine: xelatex
    extra_dependencies: ["flafter", "placeins"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,
                      warning=FALSE,
                      echo = FALSE, 
                      fig.path='figures/', 
                      floatfoot.envs = c("figure", "table", "longtabu")) 

options(scipen=2, digits=2)
```

```{r loadlibraries, include=FALSE}
library(plm)
suppressMessages(library(tidyverse))
library(bookdown)
library(gtsummary)
library(labelled)
suppressMessages(library(stargazer))
```

```{r loaddata, include=FALSE}
# rerun all code periodically
# source("../code/master.R")
load("../../data/df.rda")
# load functions
source("../../functions/add_by_n.R")
ggplot2::theme_set(ggplot2::theme_bw())  ## (sets the ggplot2 theme to theme_bw)
```

\newpage

``` {r firmregs, results = 'asis'}
x <- df %>% select(FS1.2, wave, firm_size_sans_app, dossier_selected, FS6.1, profits) %>%
  mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
         profits = profits / 605 * 12) %>% 
  group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>% ungroup()

m1 <- lm(firm_size_sans_app ~ FS6.1 + dossier_selected + as.factor(wave) + as.factor(FS1.2), data = x)
m2 <- plm(firm_size_sans_app ~ FS6.1 + as.factor(wave), data = x, index = c("FS1.2", "wave"), model = "within")
m3 <- plm(firm_size_sans_app ~ FS6.1 + dossier_selected, data = x, index = c("FS1.2", "wave"), effect = "twoway", model = "random", random.method="walhus")

m4 <- lm(profits ~ FS6.1 + dossier_selected + firm_size_sans_app + as.factor(wave) + as.factor(FS1.2), data = x)
m5 <- plm(profits ~ FS6.1 + firm_size_sans_app + as.factor(wave), data = x, index = c("FS1.2", "wave"), model = "within")
m6 <- plm(profits ~ FS6.1 + dossier_selected + firm_size_sans_app, data = x, index = c("FS1.2", "wave"), effect = "twoway", model = "random", random.method="walhus")


stargazer(m1, m2, m3, m4, m5, m6, df = FALSE, omit = "FS1.2",
          no.space = TRUE, digits = 2, header = F,
          notes = c("Omitted wave: Baseline", "$^†$Excluding apprentices."),
          notes.align = "r",
          notes.append = TRUE,
          covariate.labels = c("Apprentices",
                               "CQP participants",
                               "Employees$^†$",
                               "Wave"),
          title = "Firm-level regressions",
          omit.stat=c("aic", "bic", "adj.rsq", "ser"),
          dep.var.caption = "",
          dep.var.labels = c("Size (excluding apprentices)", "Annual profits (USD)"),
          label = "tab:firmregs")
```

``` {r expregnew, results = 'asis'}
x <- df %>% filter(SELECTED != 3)
m1 <- lm(exp_all_trades ~ as.factor(SELECTED) + as.factor(wave), data = df)
m2 <- lm(exp_all_trades ~ as.factor(SELECTED) + as.factor(wave) + as.factor(FS1.2), data = df)
m3 <- plm(exp_all_trades ~ as.factor(SELECTED) + baseline_duration + as.factor(FS1.2), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")
m4 <- plm(exp_all_trades ~ as.factor(SELECTED) + baseline_duration + firm_size_sans_app + FS6.1 + as.factor(FS1.2), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")
m5 <- plm(exp_all_trades ~ as.factor(SELECTED) + baseline_duration + firm_size_sans_app + FS6.1 + FS6.8 + FS6.9 + FS6.10 + as.factor(FS1.2), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")
m6 <- plm(exp_all_trades ~ as.factor(SELECTED) + baseline_duration + firm_size_sans_app + FS6.1 + FS6.8 + FS6.9 + FS6.10 + as.factor(FS1.2), data = x, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")

stargazer(m1, m2, m3, m4, m5, m6, df = FALSE, omit = "FS1.2", column.sep.width = "0pt",
          no.space = TRUE, digits = 2, header = F,
          notes = c("$^†$Omitted CQP category: applied but did not participate.", "$^{††}$Excluding apprentices."),
          notes.align = "r",
          notes.append = TRUE,
          covariate.labels = c("CQP participant",
                               "CQP non-applicant$^{†}$",
                               "Endline",
                               "Apprentice experience",
                               "Employees$^{††}$",
                               "Apprentices",
                               "Total instructors",
                               "Days trained per week",
                               "Duration, last training"),
          title = "Experience score regressions",
          omit.stat=c("aic", "bic", "adj.rsq", "ser"),
          dep.var.caption = "",
          dep.var.labels.include = FALSE,
          column.labels = c("\\textit{OLS}", "", "", "\\textit{random effects}", "", ""),
          model.names = FALSE,
          label = "tab:expregs",
          add.lines = list(c("Individual FE", "NO", "NO", "YES", "YES", "YES", "YES"),
                           c("Firm FE", "NO", "YES", "YES", "YES", "YES", "YES")))
```

``` {r appreg, results = 'asis'}
x <- df %>% filter(SELECTED != 3)
m1 <- lm(exp_all_trades ~ as.factor(SELECTED) + as.factor(wave), data = df)
m2 <- plm(exp_all_trades ~ as.factor(SELECTED), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")
m3 <- plm(exp_all_trades ~ as.factor(SELECTED), data = x, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")

m4 <- lm(comp_all_trades ~ as.factor(SELECTED) + as.factor(wave), data = df)
m5 <- plm(comp_all_trades ~ as.factor(SELECTED), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")
m6 <- plm(comp_all_trades ~ as.factor(SELECTED), data = x, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")

m7 <- lm(skills_all_trades ~ as.factor(SELECTED) + as.factor(wave), data = df)
m8 <- plm(skills_all_trades ~ as.factor(SELECTED), data = df, index = c("IDYouth", "wave"), model = "random", effect = "twoway", random.method="walhus")


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, df = FALSE, omit = "FS1.2", column.sep.width = "0pt",
          no.space = TRUE, digits = 2, header = F, 
          notes = c("$^†$Omitted CQP category: applied but did not participate."),
          notes.align = "r",
          notes.append = TRUE,
          covariate.labels = c("CQP participant",
                               "CQP non-applicant$^{†}$",
                               "Endline"),
          title = "Apprentice regressions",
          omit.stat=c("aic", "bic", "adj.rsq", "ser"),
          dep.var.labels = c("Experience", "Competence", "Knowledge"),
          column.labels = c("\\textit{OLS}", "\\textit{RE}", "\\textit{RE}", "\\textit{OLS}", "\\textit{RE}", "\\textit{RE}", "\\textit{OLS}", "\\textit{RE}"),
          model.names = FALSE,
          dep.var.caption = "",
          label = "tab:expregs",
          add.lines = list(c("Individual FE", "NO", "YES", "YES", "NO", "YES", "YES", "NO", "YES")))
```




assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T))
x$age
x$bornyear
x <- df %>% select(FS1.2, FS2.5_3_1, FS2.15, FS2.19, FS2.22, FS4.1, FS4.7, FS6.9, FS1.11, wave, firm_size_sans_app, selected, not_selected, did_not_apply, profits) %>% rowwise() %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
age = 80-as.numeric(FS2.5_3_1),
yos = ifelse(as.numeric(FS2.15)<23,as.numeric(FS2.15), NA),
formal = ifelse(as.numeric(FS2.19) == 1, 1, ifelse(as.numeric(FS2.19) == 2, 0, NA)),
assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T)) %>%
group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>%
mutate(apps_sans_cqp = ifelse(apps_sans_cqp > 0, log(apps_sans_cqp), NA),
select = ifelse(selected > 0, log(selected), NA),
revenues = ifelse(revenues > 0, log(revenues), NA),
profits = ifelse(profits > 0, log(profits), NA),
firm_size_sans_app = ifelse(firm_size_sans_app > 1, log(firm_size_sans_app), NA))
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
tab_model(m1)
tab_model(m1, m2)
tab_model(m1, m2, m3)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(FS1.11), data = x)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(FS1.11), data = x)
x <- df %>% select(FS1.2, FS2.5_3_1, FS2.15, FS2.19, FS2.22, FS4.1, FS4.7, FS6.9, FS1.11, wave, firm_size_sans_app, selected, not_selected, did_not_apply, profits) %>% rowwise() %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
age = 80-as.numeric(FS2.5_3_1),
yos = ifelse(as.numeric(FS2.15)<23,as.numeric(FS2.15), NA),
formal = ifelse(as.numeric(FS2.19) == 1, 1, ifelse(as.numeric(FS2.19) == 2, 0, NA)),
assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T),
trade = as.numeric(FS1.11)) %>%
group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>%
mutate(apps_sans_cqp = ifelse(apps_sans_cqp > 0, log(apps_sans_cqp), NA),
select = ifelse(selected > 0, log(selected), NA),
revenues = ifelse(revenues > 0, log(revenues), NA),
profits = ifelse(profits > 0, log(profits), NA),
firm_size_sans_app = ifelse(firm_size_sans_app > 1, log(firm_size_sans_app), NA))
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
tab_model(m1, m2, m3, m4)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m5 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m6 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m7 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m8 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m9 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m10 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m11 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m12 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m5 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m6 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m7 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m8 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m9 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m10 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m9 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m11 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + age + yos + formal + assoc + train_freq, data = x)
m12 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, df = FALSE, omit = c("FS1.2", "FS1.11)"),
no.space = TRUE, digits = 2, header = F, table.placement = "H",
notes = c("$^1$Excluding apprentices."),
notes.align = "r",
notes.append = TRUE,
covariate.labels = c("log No. of Apprentices ////
CQP Selected",
"CQP Not Selected/Did Not Apply",
"log Firm Size $^1$",
"Endline",
"MC Age",
"MC Years of Schooling",
"Formal firm$^2$",
"Trade Association$^3$",
"Training Frequency$^4$"),
title = "Firm-level regressions",
omit.stat=c("aic", "bic", "adj.rsq", "ser"),
model.names = FALSE,
dep.var.caption = "",
dep.var.labels = c("log revenues (USD)", "log profits (USD)", "log Firm size$^1$"),
label = "tab:firmregs")
x <- df %>% select(FS1.2, FS2.5_3_1, FS2.15, FS2.19, FS2.22, FS4.1, FS4.7, FS6.9, FS1.11, wave, firm_size_sans_app, selected, not_selected, did_not_apply, profits) %>% rowwise() %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
age = 80-as.numeric(FS2.5_3_1),
yos = ifelse(as.numeric(FS2.15)<23,as.numeric(FS2.15), NA),
formal = ifelse(as.numeric(FS2.19) == 1, 1, ifelse(as.numeric(FS2.19) == 2, 0, NA)),
assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T),
trade = as.numeric(FS1.11)) %>%
group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>%
mutate(apps_sans_cqp = ifelse(apps_sans_cqp > 0, log(apps_sans_cqp), NA),
select = ifelse(selected > 0, log(selected), NA),
revenues = ifelse(revenues > 0, log(revenues), NA),
profits = ifelse(profits > 0, log(profits), NA),
firm_size_sans_app = ifelse(firm_size_sans_app > 1, log(firm_size_sans_app), NA))
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m5 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m6 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m7 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq, data = x)
m8 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m9 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m10 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + age + yos + formal + assoc + train_freq, data = x)
m11 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, df = FALSE, omit = c("FS1.2", "FS1.11)"),
no.space = TRUE, digits = 2, header = F, table.placement = "H",
notes = c("$^1$Excluding apprentices."),
notes.align = "r",
notes.append = TRUE,
covariate.labels = c("log No. of Apprentices ////
CQP Selected",
"CQP Not Selected/Did Not Apply",
"log Firm Size $^1$",
"Endline",
"MC Age",
"MC Years of Schooling",
"Formal firm$^2$",
"Trade Association$^3$",
"Training Frequency$^4$"),
title = "Firm-level regressions",
omit.stat=c("aic", "bic", "adj.rsq", "ser"),
model.names = FALSE,
dep.var.caption = "",
dep.var.labels = c("log Revenues (USD)", "log profits (USD)", "log Firm size$^1$"),
label = "tab:firmregs")
unlink("markdown/cnb_apprenticeship_cache", recursive = TRUE)
y <- df %>%  mutate(posI = ifelse(cb_1 > 0, 1, 0))
y <- df %>%  mutate(posI = ifelse(cb_I > 0, 1, 0))
y <- df %>%  mutate(posII = ifelse(cb_II > 0, 1, 0))
y <- df %>%  mutate(posIII = ifelse(cb_III > 0, 1, 0))
y <- df %>%  mutate(posIV = ifelse(cb_IV > 0, 1, 0))
y <- df %>%  mutate(posV = ifelse(cb_V > 0, 1, 0))
z <- < %>% select(FS1.2, wave, contains("pos")) %>% group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>% ungroup()
z <- y%>% select(FS1.2, wave, contains("pos")) %>% group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>% ungroup()
z
y <- df %>%  mutate(posI = ifelse(cb_I > 0, 1, 0))
y <- y %>%  mutate(posII = ifelse(cb_II > 0, 1, 0))
y <- y %>%  mutate(posIII = ifelse(cb_III > 0, 1, 0))
y <- y %>%  mutate(posIII = ifelse(cb_IV > 0, 1, 0))
y <- y %>%  mutate(posIII = ifelse(cb_III > 0, 1, 0))
y <- y %>%  mutate(posIV = ifelse(cb_IV > 0, 1, 0))
y <- y %>%  mutate(posV = ifelse(cb_V > 0, 1, 0))
z <- y%>% select(FS1.2, wave, contains("pos")) %>% group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>% ungroup()
View(z)
z <- z %>% mutate(posI = ifelse(posI = 1, 1, ifelse(posI = 0, 0, 3)))
table(z$posI)
table(z$posII)
table(z$posIII)
table(z$posIV)
table(z$posV)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
x <- df %>% select(FS1.2, FS2.5_3_1, FS2.15, FS2.19, FS2.22, FS4.1, FS4.7, FS6.9, FS1.11, wave, firm_size_sans_app, selected, not_selected, did_not_apply, profits) %>% rowwise() %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
age = 80-as.numeric(FS2.5_3_1),
yos = ifelse(as.numeric(FS2.15)<23,as.numeric(FS2.15), NA),
formal = ifelse(as.numeric(FS2.19) == 1, 1, ifelse(as.numeric(FS2.19) == 2, 0, NA)),
assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T),
trade = as.numeric(FS1.11)) %>%
group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>%
mutate(apps_sans_cqp = ifelse(apps_sans_cqp > 0, log(apps_sans_cqp), NA),
select = ifelse(selected > 0, log(selected), NA),
revenues = ifelse(revenues > 0, log(revenues), NA),
profits = ifelse(profits > 0, log(profits), NA),
firm_size_sans_app = ifelse(firm_size_sans_app > 1, log(firm_size_sans_app), NA),
did = wave*selected)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did, data = x)
x$did
x$as.numeric(did)
as.numeric(x$wave)
x$wave
x <- df %>% select(FS1.2, FS2.5_3_1, FS2.15, FS2.19, FS2.22, FS4.1, FS4.7, FS6.9, FS1.11, wave, firm_size_sans_app, selected, not_selected, did_not_apply, profits) %>% rowwise() %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
age = 80-as.numeric(FS2.5_3_1),
yos = ifelse(as.numeric(FS2.15)<23,as.numeric(FS2.15), NA),
formal = ifelse(as.numeric(FS2.19) == 1, 1, ifelse(as.numeric(FS2.19) == 2, 0, NA)),
assoc = 2-as.numeric(FS2.22),
train_freq = as.numeric(FS6.9),
revenues = FS4.7/605*FS4.1,
profits = profits/605*FS4.1,
apps_sans_cqp = sum(not_selected, did_not_apply, na.rm = T),
total_apps = sum(selected, not_selected, did_not_apply, na.rm = T),
trade = as.numeric(FS1.11)) %>%
group_by(FS1.2, wave) %>% summarise_all(mean, na.rm = T) %>%
mutate(apps_sans_cqp = ifelse(apps_sans_cqp > 0, log(apps_sans_cqp), NA),
select = ifelse(selected > 0, log(selected), NA),
revenues = ifelse(revenues > 0, log(revenues), NA),
profits = ifelse(profits > 0, log(profits), NA),
firm_size_sans_app = ifelse(firm_size_sans_app > 1, log(firm_size_sans_app), NA),
did = (as.numeric(wave)-1)*selected)
m1 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m2 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m3 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did, data = x)
m4 <- lm(revenues ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m5 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m6 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app, data = x)
m7 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did, data = x)
m8 <- lm(profits ~ selected + apps_sans_cqp + as.factor(wave) + firm_size_sans_app + did + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
m9 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave), data = x)
m10 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + did, data = x)
m11 <- lm(firm_size_sans_app ~ selected + apps_sans_cqp + as.factor(wave) + did + age + yos + formal + assoc + train_freq + as.factor(trade), data = x)
stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, df = FALSE, omit = c("FS1.2", "trade)"), font.size= "scriptsize", column.sep.width = "-8pt",
no.space = TRUE, digits = 2, header = F, table.placement = "H",
notes = c("$^1$Excluding apprentices.", "$^2$Registered with the Benin Chamber of Commerce and Industry (CCIB).", "$^3$Days firm stops all activities to train, per week."),
notes.align = "r",
notes.append = TRUE,
covariate.labels = c("log No. of Apprentices: \\\\ \\\\
CQP Selected",
"CQP Not Selected/Did Not Apply",
"Endline",
"log Firm Size$^1$",
"CQP Selected x Endline",
"MC Age",
"MC Years of Schooling",
"Registered Firm$^2$",
"Trade Association",
"Training Frequency$^3$"),
title = "Firm-level regressions",
omit.stat=c("aic", "bic", "adj.rsq", "ser"),
model.names = FALSE,
dep.var.caption = "",
dep.var.labels = c("log Revenues", "log profits", "log Firm size$^1$"),
label = "tab:firmregs",
add.lines = list(c("Trade FE", "NO", "NO", "NO", "YES", "NO", "NO", "NO", "YES", "NO", "NO", "YES")))
x <- df %>% filter(wave == 0) %>% select(FS1.2, SELECTED, firm_size_bins, FS3.4, FS4.1, FS4.7, annual_app_prod, FS5.1, FS5.3, FS5.4, FS6.1, FS6.2, firm_size, profits, expenses, annual_fees, total_benefits, annual_allowances, total_training_costs, annual_foregone_prod, total_costs, contains("cb")) %>%
group_by(FS1.2) %>%
summarise_all(mean, na.rm = T) %>%
ungroup() %>%
rowwise() %>%
mutate(annual_fees_extrap = FS6.1*annual_fees,
apprentice_prod_extrap = FS6.1*annual_app_prod,
total_benefits_extrap = FS6.1*total_benefits,
annual_allowances_extrap = FS6.1*annual_allowances,
total_training_costs = total_training_costs * FS4.1,
annual_foregone_prod_extrap = FS6.1*annual_foregone_prod,
total_costs_extrap = FS6.1*total_costs,
cb_I_extrap = FS6.1*cb_I,
cb_II_extrap = FS6.1*cb_II,
cb_III_extrap = FS6.1*cb_III,
cb_IV_extrap = FS6.1*cb_IV,
cb_V_extrap = FS6.1*cb_V,
annual_revenues = FS4.7 * FS4.1,
annual_wage_bill = FS5.3 * FS4.1,
annual_non_wage_exp = FS5.1 * FS4.1,
annual_expenses = expenses * FS4.1,
annual_rep_profits = FS5.4 * FS4.1,
annual_profits = profits * FS4.1,
# rep_profitsratio_I = ifelse(cb_I >=0 & FS4.1 > 0, cb_I/annual_rep_profits, NA),
# rep_profitsratio_II = ifelse(cb_II >=0 & FS4.1 > 0, cb_II/annual_rep_profits, NA),
# rep_profitsratio_III = ifelse(cb_III >=0 & FS4.1 > 0, cb_III/annual_rep_profits, NA),
# rep_profitsratio_IV = ifelse(cb_IV >=0 & FS4.1 > 0, cb_IV/annual_rep_profits, NA),
# rep_profitsratio_V = ifelse(cb_V >=0 & FS4.1 > 0, cb_V/annual_rep_profits, NA),
# profitsratio_I = ifelse(cb_I >=0 & FS4.1 > 0, cb_I/annual_profits, NA),
# profitsratio_II = ifelse(cb_II >=0 & FS4.1 > 0, cb_II/annual_profits, NA),
# profitsratio_III = ifelse(cb_III >=0 & FS4.1 > 0, cb_III/annual_profits, NA),
# profitsratio_IV = ifelse(cb_IV >=0 & FS4.1 > 0, cb_IV/annual_profits, NA),
# profitsratio_V = ifelse(cb_V >=0 & FS4.1 > 0, cb_V/annual_profits, NA),
# expratio_I = ifelse(cb_I <0 & FS5.1>total_training_costs & FS4.1 > 0, -cb_I/(FS5.1*FS4.1-total_training_costs), NA),
# expratio_II = ifelse(cb_II <0 & FS5.1>total_training_costs & FS4.1 > 0, -cb_II/(FS5.1*FS4.1-total_training_costs), NA),
# expratio_III = ifelse(cb_III <0 & FS5.1>total_training_costs & FS4.1 > 0, -cb_III/(FS5.1*FS4.1-total_training_costs), NA),
# expratio_IV = ifelse(cb_IV <0 & FS5.1>total_training_costs & FS4.1 > 0, -cb_IV/(FS5.1*FS4.1-total_training_costs), NA),
# expratio_V = ifelse(cb_V <0 & FS5.1>total_training_costs & FS4.1 > 0, -cb_V/(FS5.1*FS4.1-total_training_costs), NA),
firm_size_bins = cut(firm_size, breaks = c(1,4,6,10,107))) %>%
mutate_at(vars(contains(c('annual', 'extrap')), total_training_costs), ~./605)
x %>% select(firm_size_bins, annual_revenues, annual_wage_bill, annual_non_wage_exp, annual_expenses, annual_rep_profits, annual_profits, annual_fees_extrap, apprentice_prod_extrap, total_benefits_extrap, annual_allowances_extrap, total_training_costs, annual_foregone_prod_extrap, total_costs_extrap, contains(c("extrap", 'ratio'))) %>%
tbl_summary(by = firm_size_bins,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = list(everything() ~ c(0, 0)),
label = list(annual_revenues ~ "Revenues",
annual_wage_bill ~ "Wage bill",
annual_non_wage_exp ~ "Non-wage expenses",
annual_expenses ~ "Total expenses",
annual_rep_profits ~ "Profits (reported)",
annual_profits ~ "Profits² (calculated²)",
annual_fees_extrap ~ "Fees",
apprentice_prod_extrap ~ "Apprentice prod.",
total_benefits_extrap ~ "Total",
annual_allowances_extrap ~ "Allowances",
total_training_costs ~ "Training costs",
annual_foregone_prod_extrap ~ "Lost trainer prod.",
total_costs_extrap ~ "Total",
cb_I_extrap ~ "Model I",
cb_II_extrap ~ "Model II",
cb_III_extrap ~ "Model III",
cb_IV_extrap ~ "Model IV",
cb_V_extrap ~ "Model V")) %>%
add_overall() %>%
modify_header(label = "") %>%
modify_spanning_header(c(stat_1, stat_2, stat_3, stat_4) ~ "**Firm size¹**") %>%
modify_footnote(update = everything() ~ NA) %>%
as_kable_extra(caption = "Annual net benefits per firm",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::group_rows(start_row = 1,
end_row = 6,
group_label = "Firm Accounts") %>%
kableExtra::group_rows(start_row = 7,
end_row = 9,
group_label = "Projected benefits") %>%
kableExtra::group_rows(start_row = 10,
end_row = 13,
group_label = "Projected costs") %>%
kableExtra::group_rows(start_row = 14,
end_row = 18,
group_label = "Net benefits") %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Net benefits per firm estimated using baseline data. \nProjected costs, benefits, and net benefits calculated as mean values for all observed apprentices in \nfirm times reported number of apprentices trained. Amounts in \\\\$US.",
number = c("Firms size calculated by author as sum of all reported workers in firm, including apprentices and occasional and family workers.",
"Profits recalculated by author as difference between reported revenues (first row) and reported expenses (second row)."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
unlink("~/polybox/Personal/admin/CV/short_de/CV_short_de_cache", recursive = TRUE)
apps <- df %>% mutate(N = 1) %>%  select(N, age, sex, FS1.11, duration, grad, schooling, wave)
apps$schooling
as.factor(apps$schooling)
factor(apps$schooling)
levels(apps$schooling)
apps <- df %>% mutate(N = 1) %>%  select(N, age, sex, FS1.11, duration, grad, schooling, wave) %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
schooling = factor(schooling, levels = c(6,3,1,2,4,5), labels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=wave,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "NA%", "-", stat_1))) %>%
modify_footnote(update = everything() ~ NA)
apps
apps <- df %>% mutate(N = 1) %>%  select(N, age, sex, FS1.11, duration, grad, schooling, wave) %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=wave,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "NA%", "-", stat_1))) %>%
modify_footnote(update = everything() ~ NA)
apps
apps <- df %>% mutate(N = 1) %>%  select(N, age, sex, FS1.11, duration, grad, schooling, wave) %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
schooling = factor(schooling, levels = c(6,3,1,2,4,5), labels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11)
apps$schooling
apps <- df %>% mutate(N = 1) %>%  select(N, age, sex, FS1.11, duration, grad, schooling, wave) %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
schooling = factor(schooling, levels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=wave,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "NA%", "-", stat_1))) %>%
modify_footnote(update = everything() ~ NA)
apps
y <- df %>% mutate(N = 1) %>% filter(wave == 0) %>% select(N, age, sex, SELECTED, FS1.11, duration, grad, schooling) %>%
mutate(wave = factor(wave, levels = 0:1, labels = c('Baseline', 'Endline')),
schooling = factor(schooling, levels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=SELECTED,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_footnote(update = everything() ~ NA)
y <- df %>% mutate(N = 1) %>% filter(wave == 0) %>% select(N, age, sex, SELECTED, FS1.11, duration, grad, schooling) %>%
mutate(schooling = factor(schooling, levels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.')),
grad = ifelse(wave == "Baseline", NA, grad)) %>%
mutate(grad = factor(grad, labels = c("Still training", "Graduated", "Dropped out", "Unknown"))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=SELECTED,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_footnote(update = everything() ~ NA)
y <- df %>% mutate(N = 1) %>% filter(wave == 0) %>% select(N, age, sex, SELECTED, FS1.11, duration, grad, schooling) %>%
mutate(schooling = factor(schooling, levels = c('None', '<Primary', 'Primary', 'Secondary', 'Technical', 'Tertiary')),
SELECTED = factor(SELECTED, levels = c(1, 0, 3),
labels = c('Selected', 'Not Selected', 'Did Not Apply')),
sex = factor(sex, levels = 0:1, labels = c("Female", "Male")),
FS1.11 = factor(FS1.11, labels = c('Masonry', 'Carpentry', 'Plumbing', 'Metalworking', 'Electrical Inst.'))) %>%
rename("Age" = age, "Male" = sex, "Trade" = FS1.11) %>%
tbl_summary(by=SELECTED,
type = list(Age ~ "continuous",
duration ~ "continuous",
Male ~ "dichotomous"),
value = Male ~ "Male",
statistic = list(all_continuous() ~ c("{mean} ({sd})"),
all_categorical() ~ c("{p}%"),
N ~ "{N}"),
missing = "no",
label = list(Trade ~ "Trade",
duration ~ "Years in training",
schooling ~ "Education",
grad ~ "Status at endline")) %>%
modify_header(all_stat_cols() ~ "**{level}**") %>%
modify_footnote(update = everything() ~ NA)
View(x)

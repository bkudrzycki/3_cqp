digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(12:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(10, level_of_indent = -1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(10, level_of_indent = -.5) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(10, level_of_indent = 0) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 10,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = everything() ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = list(c("total_fees", "fee_entry", "fee_formation", "fee_liberation", "fee_materials", "fee_contract", "fee_application", "all_allowances", "allow_food", "allow_transport", "allow_pocket_money", "allow_other", "net_benefits")) ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = c("total_fees", "fee_entry", "fee_formation", "fee_liberation", "fee_materials", "fee_contract", "fee_application", "all_allowances", "allow_food", "allow_transport", "allow_pocket_money", "allow_other", "net_benefits") ~ "aov") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result."),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = c("total_fees", "fee_entry", "fee_formation", "fee_liberation", "fee_materials", "fee_contract", "fee_application", "all_allowances", "allow_food", "allow_transport", "allow_pocket_money", "allow_other", "net_benefits") ~ "aov",
test = c("a_total_fees", "a_fee_entry", "a_fee_formation", "a_fee_liberation", "a_fee_materials", "a_fee_contract", "a_fee_application", "a_allow", "a_net_benefits") ~ "wilcox.test") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**",
p.value = "**p-value³**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result.", "Analysis of variance for three groups, Wilcoxon rank sum test for two groups"),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = list(c("total_fees", "fee_entry", "fee_formation", "fee_liberation", "fee_materials", "fee_contract", "fee_application", "all_allowances", "allow_food", "allow_transport", "allow_pocket_money", "allow_other", "net_benefits") ~ "aov",
c("a_total_fees", "a_fee_entry", "a_fee_formation", "a_fee_liberation", "a_fee_materials", "a_fee_contract", "a_fee_application", "a_allow", "a_net_benefits") ~ "wilcox.test")) %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**",
p.value = "**p-value³**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result.", "Analysis of variance for three groups, Wilcoxon rank sum test for two groups"),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
tbl_summary(x, by = SELECTED,
type = everything() ~ "continuous",
statistic = all_continuous() ~ c("{mean} ({sd})"),
missing = "no",
digits = everything() ~ 2) %>%
add_overall() %>%
add_p(test = list(c("total_fees", "fee_entry", "fee_formation", "fee_liberation", "fee_materials", "fee_contract", "fee_application", "all_allowances", "allow_food", "allow_transport", "allow_pocket_money", "allow_other", "net_benefits") ~ "aov",
c("a_total_fees", "a_fee_entry", "a_fee_formation", "a_fee_liberation", "a_fee_materials", "a_fee_contract", "a_fee_application", "a_allow", "a_net_benefits") ~ "wilcox.test")) %>%
modify_footnote(update = everything() ~ NA) %>%
modify_header(update = list(all_stat_cols(FALSE) ~ "**{level}**",
stat_0 ~ "**Overall**",
p.value = "**p-value³**")) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_3 = ifelse(stat_3 == "NA (NA)", "-", stat_3))) %>%
as_kable_extra(caption = "Annual costs and benefits accruing to apprentice",
booktabs = T,
linesep = "",
position = "H") %>%
kableExtra::add_indent(c(2:7), level_of_indent = 1) %>%
kableExtra::add_indent(c(11:16), level_of_indent = 1) %>%
kableExtra::add_indent(c(18:21), level_of_indent = 1) %>%
kableExtra::group_rows(start_row = 1,
end_row = 9,
group_label = "Apprentice survey:") %>%
kableExtra::group_rows(start_row = 10,
end_row = 22,
group_label = "Firm survey:") %>%
kableExtra::row_spec(c(9,22), bold=T) %>%
kableExtra::kable_styling(latex_options="scale_down") %>%
footnote(general = "Mean (SD). Amounts in \\\\$US per apprentice per year, calculated using responses from baseline survey. Annual fees assume apprenticeship duration of four years.",
number = c("Apprentices were only asked about total allowances received.", "Rows missing all allowance or all fee data were excluded from net benefit calculation. Mean net benefit may deviate from difference in mean allowances and mean fees as a result.", "Wilcoxon rank sum test for apprentice survey, analysis of variance for firm data"),
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "")
source("/Volumes/nadel/research/Data/PhDs/Bart 2022/Paper 3 - CQP/master.R", echo=TRUE)
source("~/polybox/Youth Employment/2 CQP/Paper/code/prep/cleaning.R", echo=TRUE)
rm path
rm(path)
source("~/polybox/Youth Employment/2 CQP/Paper/code/prep/cleaning.R", echo=TRUE)
# Set working directory
if(!exists(path)){
setwd("~/polybox/Youth Employment/2 CQP/Paper")
}else{
setwd(path)
}
# Set working directory
if(!exists("path")){
setwd("~/polybox/Youth Employment/2 CQP/Paper")
}else{
setwd(path)
}
getwd()
source("~/polybox/Youth Employment/2 CQP/Paper/code/prep/cleaning.R", echo=TRUE)
# Endline cleaning
fs_end <- read_sav("data/source/Enquête+auprès+des+patrons+-+endline_October+6,+2021_12.12.sav", user_na = TRUE)
ys <- read_sav("data/youth_survey_merged2.sav") %>%
filter(cqp == 1) %>%
select(tidyselect::vars_select(names(.), -matches(c('A1', 'A4', 'A5', 'A6', 'A7', 'F1', 'F2', 'F3', 'FS')))) %>%
rename_all(~stringr::str_replace(., "^YS10_", "YS10.")) %>%
rename_all(~stringr::str_replace(., "^YS1_", "YS1.")) %>%
rename_all(~stringr::str_replace(., "^YS2_", "YS2.")) %>%
rename_all(~stringr::str_replace(., "^YS3_", "YS3.")) %>%
rename_all(~stringr::str_replace(., "^YS4_", "YS4.")) %>%
rename_all(~stringr::str_replace(., "^YS5_", "YS5.")) %>%
rename_all(~stringr::str_replace(., "^YS6_", "YS6.")) %>%
rename_all(~stringr::str_replace(., "^YS7_", "YS7.")) %>%
rename_all(~stringr::str_replace(., "^YS8_", "YS8.")) %>%
rename_all(~stringr::str_replace(., "^YS9_", "YS9.")) %>%
rename_all(~stringr::str_replace(., "^YE10_", "YE10.")) %>%
rename_all(~stringr::str_replace(., "^YE1_", "YE1.")) %>%
rename_all(~stringr::str_replace(., "^YE2_", "YE2.")) %>%
rename_all(~stringr::str_replace(., "^YE3_", "YE3.")) %>%
rename_all(~stringr::str_replace(., "^YE4_", "YE4.")) %>%
rename_all(~stringr::str_replace(., "^YE5_", "YE5.")) %>%
rename_all(~stringr::str_replace(., "^YE6_", "YE6.")) %>%
rename_all(~stringr::str_replace(., "^YE7_", "YE7.")) %>%
rename_all(~stringr::str_replace(., "^YE8_", "YE8.")) %>%
rename_all(~stringr::str_replace(., "^YE9_", "YE9.")) %>%
mutate(IDYouth = as.numeric(str_remove(IDYouth, 'CQP')))
ys <- read_sav("data/youth_survey_merged2.sav") %>%
filter(cqp == 1) %>%
select(tidyselect::vars_select(names(.), -matches(c('A1', 'A4', 'A5', 'A6', 'A7', 'F1', 'F2', 'F3', 'FS')))) %>%
rename_all(~stringr::str_replace(., "^YS10_", "YS10.")) %>%
rename_all(~stringr::str_replace(., "^YS1_", "YS1.")) %>%
rename_all(~stringr::str_replace(., "^YS2_", "YS2.")) %>%
rename_all(~stringr::str_replace(., "^YS3_", "YS3.")) %>%
rename_all(~stringr::str_replace(., "^YS4_", "YS4.")) %>%
rename_all(~stringr::str_replace(., "^YS5_", "YS5.")) %>%
rename_all(~stringr::str_replace(., "^YS6_", "YS6.")) %>%
rename_all(~stringr::str_replace(., "^YS7_", "YS7.")) %>%
rename_all(~stringr::str_replace(., "^YS8_", "YS8.")) %>%
rename_all(~stringr::str_replace(., "^YS9_", "YS9.")) %>%
rename_all(~stringr::str_replace(., "^YE10_", "YE10.")) %>%
rename_all(~stringr::str_replace(., "^YE1_", "YE1.")) %>%
rename_all(~stringr::str_replace(., "^YE2_", "YE2.")) %>%
rename_all(~stringr::str_replace(., "^YE3_", "YE3.")) %>%
rename_all(~stringr::str_replace(., "^YE4_", "YE4.")) %>%
rename_all(~stringr::str_replace(., "^YE5_", "YE5.")) %>%
rename_all(~stringr::str_replace(., "^YE6_", "YE6.")) %>%
rename_all(~stringr::str_replace(., "^YE7_", "YE7.")) %>%
rename_all(~stringr::str_replace(., "^YE8_", "YE8.")) %>%
rename_all(~stringr::str_replace(., "^YE9_", "YE9.")) %>%
mutate(IDYouth = as.numeric(str_remove(IDYouth, 'CQP')))
ys <- read_sav("data/youth_survey_merged2.sav") %>%
filter(cqp == 1) %>%
select(tidyselect::vars_select(names(.), -matches(c('A1', 'A4', 'A5', 'A6', 'A7', 'F1', 'F2', 'F3', 'FS')))) %>%
rename_all(~stringr::str_replace(., "^YS10_", "YS10.")) %>%
rename_all(~stringr::str_replace(., "^YS1_", "YS1.")) %>%
rename_all(~stringr::str_replace(., "^YS2_", "YS2.")) %>%
rename_all(~stringr::str_replace(., "^YS3_", "YS3.")) %>%
rename_all(~stringr::str_replace(., "^YS4_", "YS4.")) %>%
rename_all(~stringr::str_replace(., "^YS5_", "YS5.")) %>%
rename_all(~stringr::str_replace(., "^YS6_", "YS6.")) %>%
rename_all(~stringr::str_replace(., "^YS7_", "YS7.")) %>%
rename_all(~stringr::str_replace(., "^YS8_", "YS8.")) %>%
rename_all(~stringr::str_replace(., "^YS9_", "YS9.")) %>%
rename_all(~stringr::str_replace(., "^YE10_", "YE10.")) %>%
rename_all(~stringr::str_replace(., "^YE1_", "YE1.")) %>%
rename_all(~stringr::str_replace(., "^YE2_", "YE2.")) %>%
rename_all(~stringr::str_replace(., "^YE3_", "YE3.")) %>%
rename_all(~stringr::str_replace(., "^YE4_", "YE4.")) %>%
rename_all(~stringr::str_replace(., "^YE5_", "YE5.")) %>%
rename_all(~stringr::str_replace(., "^YE6_", "YE6.")) %>%
rename_all(~stringr::str_replace(., "^YE7_", "YE7.")) %>%
rename_all(~stringr::str_replace(., "^YE8_", "YE8.")) %>%
rename_all(~stringr::str_replace(., "^YE9_", "YE9.")) %>%
mutate(IDYouth = as.numeric(str_remove(IDYouth, 'CQP')))
source("~/polybox/Youth Employment/2 CQP/Paper/master.R", echo=TRUE)
source("~/polybox/Youth Employment/2 CQP/Paper/master.R", echo=TRUE)
# set user path: e.g. /Volumes/nadel/research/Data/PhDs/Bart 2022/Paper 3 - CQP
path <- "~/polybox/Youth Employment/2 CQP/Paper"
setwd(path)
#clean and reshape data
source("code/prep/cleaning.R") #clean youth survey and firm survey
# inputs:
# - Stata-cleaned youth survey data ("data/youth_survey_merged.sav")
# - Raw firm survey baseline data ("data/source/Enquête+auprès+des+patrons_February+10,+2020_13.28.sav")
# - Raw firm survey endline data and supplement ("data/source/Enquête+auprès+des+patrons+-+endline_October+6,+2021_12.12.sav", "data/source/Enquête+des+jeunes+-+endline+-+supplementaire_November+18,+2021_22.23.sav")
# - Dossier data: CQP applications and admission ("data/selected_new.xls")
# outputs:
# - Cleaned youth data ("data/ys.rda")
# - Cleaned firm data ("data/fs.rda" and "data/fs_end.rda")
source("code/prep/pivot_longer.R") # extract individual apprentice assessments from firm surveys for matching to apprentice data
# Inputs: "data/fs.rda" and "data/fs_end.rda"
# Outputs: "data/base_cqps.rda", "data/base_trad.rda", "data/end_cqps.rda", and "data/end_trad.rda
source("code/prep/recode.R")
